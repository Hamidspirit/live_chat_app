{% extends 'base.html' %}

{% block title %} Login {% endblock %}
{% block content %}

{% if not current_user.is_authenticated %}
    <div class="auth_container">
        <h1>Login Form</h1>
        {% for message in get_flashed_messages() %}
            <div class="alert alert-info alert-dismissible  show" role="alert">
                {{ message }}
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
        {% endfor %}
        <form  id="login_form" method="post">
            <input type="text" id="username" name="username" placeholder="Username" required>
            <input type="text" id="password" name="password" placeholder="Password" required>
            <button type="submit" class="btn">Login</button>
        </form>
        <p>Don't have an Account <a href="/register" id="link">Register</a></p>
    </div>
{% else %}
    <div id="error_message">
        <h2>You are loged in!</h2>
        <a href="/">Go to main page</a>
    </div>
{% endif %}
<!-- <script>
    document.getElementById('login_form').addEventListener('submit',async (e)=>{
        e.preventDefault();
        const username = getElementById('username').value;
        const password = getElementById('password').value;

        const response = await fetch('/login', {
            method: 'POST',
            headers: {'content-type': 'aplication/json'},
            body: JSON.stringify({username, password}),

        })
        
        const data = await response.json();
        if(response.ok){
            alert("Login Seccessful")
            window.location.href = '/';// redirect to chat page
        }else{
            alert(data.error);
        }

    })

    document.getElementById('register_link').addEventListener('click', ()=>{
        window.location.href = '/register.html';// redirect to registration page
    })

</script> -->
{% endblock %}